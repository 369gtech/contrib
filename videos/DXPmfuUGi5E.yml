# Editing guidelines: https://github.com/watch-devtube/contrib/#how-to-edit-video-metadata


tags:
    - security
title: '#HITBGSEC 2018 COMMSEC: Monitoring Native Execution In WoW64 Apps - Y. Shafir and A. Carlsbad'
recordingDate: 1537130742
description: "WoW64 processes have a complete 32-bit subsystem inside of them, in charge of supplying the 32-bit application with everything it needs to execute on a 64-bit OS. But eventually, the communication with the 64-bit environment itself is done by the 64-bit portion of the process, often neglected by security products. Mostly, only monitoring the 32-bit subsystem is enough, but bypasses techniques such as the notorious “Heaven’s Gate” prove that this approach is far from perfect.\n\nIn this talk, we wish to present the possibility of injecting 64-bit DLLs into WoW64 processes and use these to hook 64-bit APIs. This task introduces some unique challenges, which we will discuss in detail. We will present several injection methods, including a couple of novel modifications for existing ones, that enable injecting a 64-bit DLL into a WoW64 process. We will then demonstrate the adjustments we made to an out-of-the-box hooking engine to make it able to hook 64-bit APIs in the process. Some changes in new Windows versions, such as the introducing of CFG and the changes to some API functions, made this task more challenging, and we will show how we researched these and solved these issues, making this hooking technique useful on all currently available Windows versions.\n\n=== \n\nYarden is a security researcher working in infosec in the past few years. Currently she is a member of the research group at SentinelOne. Her interests include diving deep into OS internals, reverse engineering things which shouldn’t have been compiled in the first place, researching exploit mitigations, and causing blue screens. In her spare time she performs in the circus, specializing in aerial acrobatics.\n\n--- \n\nAssaf is a security researcher @SentinelOne"
