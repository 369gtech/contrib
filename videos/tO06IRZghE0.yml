# Contribution guide: https://github.com/watch-devtube/contrib

# speaker:
#   name: _____
#   twitter: _____ # mandatory twitter handle; must not include @

# tags: [____, _____, _____]

tags:
    - mobile
    - android
    - security
    - testing
    - embedded
title: '#HITBLockdown002 D1T1 - The Secret Codes Tell the Secrets - Zhang Qing & Bai Guangdong'
language: English
recordingDate: 1596494662
description: "Android devices hold a large amount of information about its hardware and system that an average user might find difficult to access. But if the attacker knows Android’s secret codes, he can factory reset the device, find out its hidden camera information, instantly back up user’s sensitive data and much more.\n\n\n\nMost of these secret codes come from the factory-installed apps such as EngineerMode or wt_secret_code_manager, and few may be embedded in the basic apps such as contacts, calendar and so on. In 2017, a security researcher pointed out that oneplus device has a backdoor in EngineerMode app for diagnostics mode which can lead to root exploit. On Twitter, Qualcomm VP of Product Security Engineering Alex Gantman stated that the EngineerMode app was not authored by Qualcomm but others who had built it on top of a previous testing app. Engineeringmode app and other apps which have the secret codes mostly are built-in system-signed and these apps have lots special and externally accessible privileges for convenience, so there are lots of exposed attack surfaces and may bring lots damage for the users.\n\n\nIn this presentation, we will introduce many authentication bypass and privilege escalation vulnerabilities in the top mobile vendors’ phones. Among them, most are system reset bypass. We also find that lock-screen PINs are leaked through logcat in several phones. What’s more, in some devices using the Engineeringmode can reboot to Qualcomm’s Kernel FFBM mode which need to erase misc partition to exit. The misc partition in android device contains many important information about the settings such as usb/CID（Carrier or Region ID), which may influence the device’s functions if this partition is damaged. Even worse, the OTA update may be controlled. All the vulnerabilities found by us breach Android’s permission system. We also build a fuzzing tool which can scan through all available secret codes on the device.\n\n\nTo demonstrate the effectiveness of our method, we apply it on OEM devices such as Samsung, Huawei, oppo, vivo, meizu, xiaomi and Smartisan OS. This has found an average of 5 vulnerabilities on each device due to secret code leakage. We have identified in total 50+ bugs and vulnerabilities, including many severe ones. During the presentation, we will select typical ones to demonstrate, aiming to inspire the community with those vulnerabilities that have not yet been identified and shown by other methods.\n\n\n===\n\n\nDr. Zhang Qing is a senior security researcher. Previously, he was a senior Android security researcher of Qihoo 360 and visiting scholar of Model Checking Lab in National University of Singapore. His interests include Android security, IoT security and payment security, specializing in reverse engineering and fuzzing. His work has appeared at syscan360 2016, Black Hat 2017, HITB 2017，HITB 2018 and so on. In 2016，2017 and 2018, he won whole year’s first-place prizes in vulnerability detection of some major companies, such as Samsung, Huawei, Meizu, Chuizi and OPPO.\n\n\n\n--- \n\n\nDr. Bai Guangdong is a faculty member in Singapore Institute of Technology (SIT). He received his PhD degree from National University of Singapore in 2015. His research interest spans across the broad areas of mobile security, web security, and protocol verification. During his previous research, he has worked on analyzing authentication protocol implementation, online payment, and Android security. His research has helped identify and fix serious security vulnerabilities for major websites like Sina Weibo. His work appears in top security conferences, such as NDSS, Syscan, HITB and Black Hat Europe."
