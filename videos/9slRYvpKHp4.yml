# Contribution guide: https://github.com/watch-devtube/contrib

# speaker:
#   name: _____
#   twitter: _____ # mandatory twitter handle; must not include @

# tags: [____, _____, _____]

title: 'DEF CON 29 - Jenko Hwong - New Phishing Attacks Exploiting OAuth Authentication Flows'
language: English
recordingDate: 1628185141
description: "OAuth 2.0 device authentication gives users on limited-input devices like TVs an easier way to authenticate against a cloud website/app by entering a code on a computer/phone. This authentication flow leads to new phishing attacks that:\n- do not need server infrastructure--the login page is served by the authorization provider using their domain and cert\n- do not require a client application--application identities can be reused/spoofed\n- do not require user consent of application permissions\n\nSince the phish attacks hijack oauth session tokens, MFA will be ineffective as the attacker does not need to reauthenticate. The ability to defend against these attacks is hindered by limited info and functionality to detect, mitigate, and prevent session token compromise.\n\nI'll demonstrate these new phishing attacks, access to sensitive user data, and lateral movement.\n\nDefensive measures against these phishing attacks will be discussed, specifically the challenges in detection, mitigation, and prevention, and the overall lack of support for managing temporary credentials.\n\nOpen-source tools have been developed and will be used to demonstrate how users can:\n- self-phish their organizations using these techniques\n- audit security settings that help prevent/mitigate the attacks\n\nREFERENCES:\n1.0 Evolving Phishing Attacks\n1.1 A Big Catch: Cloud Phishing from Google App Engine and Azure App Service:\nhttps://www.netskope.com/blog/a-big-catch-cloud-phishing-from-google-app-engine-and-azure-app-service\n1.2 Microsoft Seizes Malicious Domains Used in Mass Office 365 Attacks:\nhttps://threatpost.com/microsoft-seizes-domains-office-365-phishing-scam/157261/\n1.3 Phishing Attack Hijacks Office 365 Accounts Using OAuth Apps:\nhttps://www.bleepingcomputer.com/news/security/phishing-attack-hijacks-office-365-accounts-using-oauth-apps/\n1.4 Office 365 Phishing Attack Leverages Real-Time Active Directory Validation:\nhttps://threatpost.com/office-365-phishing-attack-leverages-real-time-active-directory-validation/159188/\n1.5 Demonstration - Illicit Consent Grant Attack in Azure AD:\nhttps://www.nixu.com/blog/demonstration-illicit-consent-grant-attack-azure-ad-office-365\nhttps://securecloud.blog/2018/10/02/demonstration-illicit-consent-grant-attack-in-azure-ad-office-365/\n1.6 Detection and Mitigation of Illicit Consent Grant Attacks in Azure AD:\nhttps://www.cloud-architekt.net/detection-and-mitigation-consent-grant-attacks-azuread/\n1.7 HelSec Azure AD write-up: Phishing on Steroids with Azure AD Consent Extractor:\nhttps://securecloud.blog/2019/12/17/helsec-azure-ad-write-up-phishing-on-steroids-with-azure-ad-consent-extractor/ 1.8 Pawn Storm Abuses OAuth In Social Engineering Attack:\nhttps://www.trendmicro.com/en_us/research/17/d/pawn-storm-abuses-open-authentication-advanced-social-engineering-attacks.html\n\n2.0 OAuth Device Code Flow\n2.1 OAuth 2.0 RFC:\nhttps://tools.ietf.org/html/rfc6749#page-24\n2.2 OAuth 2.0 for TV and Limited-Input Device Applications:\nhttps://developers.google.com/identity/protocols/oauth2/limited-input-device\n2.3 OAuth 2.0 Scopes for Google APIs:\nhttps://developers.google.com/identity/protocols/oauth2/scopes\n2.2 Introducing a new phishing technique for compomising Office 365 accounts:\nhttps://o365blog.com/post/phishing/#oauth-consent\n2.3. Office Device Code Phishing:\nhttps://gist.github.com/Mr-Un1k0d3r/afef5a80cb72dfeaa78d14465fb0d333\n\n3.0 Additional OAuth Research Areas\n3.1 Poor OAuth implementation leaves millions at risk of stolen data:\nhttps://searchsecurity.techtarget.com/news/450402565/Poor-OAuth-implementation-leaves-millions-at-risk-of-stolen-data\n3.2 How did a full access OAuth token get issued to the Pok√©mon GO app?:\nhttps://searchsecurity.techtarget.com/answer/How-did-a-full-access-OAuth-token-get-issued-to-the-Pokemon-GO-app\n==="
